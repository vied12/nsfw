<div class="Station">
    <div class="row">
        <div class="col-md-12">
            <h1>
                {{'Station'|translate}}:
                <span ng-bind-html="vm.station.name"></span>
                <a href="#map" uib-tooltip="See on a map"><i class="material-icons">map</i></a>
            </h1>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <form ng-submit="vm.subscribe()">
                <div class="form-group">
                    <label for="inputEmail1"><i class="material-icons">notifications_active</i> {{ 'Leave your email address to receive alerts' | translate }}</label>
                    <div class="row" ng-if="!vm.subscribed">
                        <div class="col-sm-8">
                            <input type="email" class="form-control" id="inputEmail1" ng-model="vm.email" placeholder="Email">
                        </div>
                        <div class="col-sm-4">
                            <button type="submit" class="btn btn-primary" translate>Subscribe</button>
                        </div>
                    </div>
                    <div ng-if="vm.subscribed" translate>Subscribed!</div>
                    <div ng-if="vm.errorOnSubscription" translate>an error occured!</div>
                </div>
            </form>
            <span translate>You can also subscribe to its <a target="_blank" href="/alerts/rss/{{vm.station.id}}">Rss</a> or <a target="_blank" href="/alerts/atom/{{vm.station.id}}">Atom</a> feeds <i class="material-icons">rss_feed</i></span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12" ng-if="vm.station.pm10_data && vm.mp10Average">
            <h2 translate>Summary</h2>
            <div class="table-responsive">
                <table class="table Station__stats">
                    <thead>
                        <th>
                        </th>
                        <th>
                            <i class="material-icons md-36">today</i>
                            <div class="">Last value</div>
                        </th>
                        <th>
                            <i class="material-icons md-36">insert_chart</i>
                            <div class="">Average during last year</div>
                        </th>
                        <th>
                            <i class="material-icons md-36">error</i>
                            <div class="">Polluted days<br/>during last year</div>
                        </th>
                        <th>
                            <i class="material-icons md-36">flash_on</i>
                            <div class="">Longest pollution streak<br/> during last year</div>
                        </th>
                    </thead>
                    <tbody>
                        <tr>
                            <th><span class="label label-danger">PM10</span></th>
                            <td>
                                <div class="number">{{ vm.mp10LastMeasure.value }}µg/m³</div>
                                <div class="description">{{ vm.moment(vm.mp10LastMeasure.date).format('ll') }}</div>
                            </td>
                            <td>
                                <div class="number">{{ vm.mp10Average | number:0 }}µg/m³</div>
                            </td>
                            <td>
                                <div class="number">{{ vm.mp10Sum }} days</div>
                            </td>
                            <td>
                                <div ng-if="!vm.mp10LongestStreak.value">
                                    <div class="number">—</div>
                                </div>
                                <div ng-if="vm.mp10LongestStreak.value">
                                    <div class="number">{{ vm.mp10LongestStreak.value }} {{'days'|translate}}</div>
                                    <div class="description">
                                        {{ vm.moment(vm.mp10LongestStreak.date).format('ll') }} -
                                        {{ vm.moment(vm.mp10LongestStreak.toDate).format('ll') }}
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th><span class="label label-danger">No2</span></th>
                            <td>
                                <div class="number">{{ vm.no2LastMeasure.value }}µg/m³</div>
                                <div class="description">{{ vm.moment(vm.no2LastMeasure.date).format('ll') }}</div>
                            </td>
                            <td>
                                <div class="number">{{ vm.no2Average | number:0 }}µg/m³</div>
                            </td>
                            <td>
                                <div class="number">{{ vm.no2Sum }} days</div>
                            </td>
                            <td>
                                <div ng-if="!vm.no2LongestStreak.value">
                                    <div class="number">—</div>
                                </div>
                                <div ng-if="vm.no2LongestStreak.value">
                                    <div class="number">{{ vm.no2LongestStreak.value }} {{'days'|translate}}</div>
                                    <div class="description">
                                        {{ vm.moment(vm.no2LongestStreak.date).format('ll') }} -
                                        {{ vm.moment(vm.no2LongestStreak.toDate).format('ll') }}
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="help-block" translate>
                PM10 is an important indicator of urban air pollution, and the health risks associated with the complex mixtures of pollutants typically found in cities. The smaller PM10 particles are able to penetrate deep into the lungs, and also to cross into the blood, causing damage in many organ systems.
            </div>
        </div>
    </div>
    <div class="row" ng-if="::!vm.station.pm10_data || !vm.mp10Average">
        <h2 translate>Last alerts on this station</h2>
        <div ng-if="vm.alerts.length < 1" translate>No alert found</div>
        <last-alert data-alerts="::vm.alerts" data-hide-station="true"></last-alert>
    </div>
    <div class="row" ng-if="::vm.isDatavisPossible">
        <div class="col-md-12">
            <h2 translate>PM10 particles pollution in time</h2>
        </div>
        <div class="col-md-12" style="overflow-x: auto;">
            <nsfw-datavis data-station="::vm.station"></nsfw-datavis>
        </div>
    </div>
    <h2 id="map" translate>Where the data come from</h2>
    <leaflet defaults="vm.defaults" lf-center="vm.center" markers="vm.markers" height="320px" width="100%"></leaflet>

</div>
